# RLS Matrix

## Summary
- Tables created in migrations: 45
- Tables with RLS enabled: 46
- Tables missing RLS enable (from migrations): app.course_entitlements
- Tables with RLS enabled but no policies: none found

## Policy Matrix
| Table | RLS | Command | Role | Policy | Using | With Check | Source |
| --- | --- | --- | --- | --- | --- | --- | --- |
| `app.activities` | enabled | select | authenticated | `activities_read` | `true` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.activities` | enabled | all | public/auth/default | `activities_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.activities` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.app_config` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.auth_events` | enabled | all | public/auth/default | `auth_events_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.auth_events` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.billing_logs` | enabled | all | public/auth/default | `billing_logs_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.billing_logs` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.certificates` | enabled | all | public/auth/default | `certificates_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.certificates` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.course_bundle_courses` | enabled | all | public/auth/default | `course_bundle_courses_owner` | `auth.uid() in ( select teacher_id from app.course_bundles where id = bundle_id )` | `auth.uid() in ( select teacher_id from app.course_bundles where id = bundle_id )` | `supabase/migrations/016_course_bundles.sql` |
| `app.course_bundles` | enabled | all | public/auth/default | `course_bundles_owner_write` | `auth.uid() = teacher_id` | `auth.uid() = teacher_id` | `supabase/migrations/016_course_bundles.sql` |
| `app.course_bundles` | enabled | select | public/auth/default | `course_bundles_public_read` | `is_active = true` | `` | `supabase/migrations/016_course_bundles.sql` |
| `app.course_display_priorities` | enabled | all | authenticated | `course_display_owner` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.course_display_priorities` | enabled | all | public/auth/default | `course_display_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.course_display_priorities` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.course_quizzes` | enabled | all | public/auth/default | `quizzes_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.course_quizzes` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.courses` | enabled | all | authenticated | `courses_owner_write` | `created_by = auth.uid() or app.is_admin(auth.uid())` | `created_by = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.courses` | enabled | select | public | `courses_public_read` | `is_published = true or created_by = auth.uid() or app.is_admin(auth.uid())` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.courses` | enabled | all | public/auth/default | `courses_service_role` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.courses` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.enrollments` | enabled | all | public/auth/default | `enrollments_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.enrollments` | enabled | all | authenticated | `enrollments_user` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.courses c where c.id = course_id and c.created_by = auth.uid() )` | `user_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.enrollments` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.follows` | enabled | all | authenticated | `follows_user` | `follower_id = auth.uid() or app.is_admin(auth.uid())` | `follower_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.follows` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.lesson_media` | enabled | select | authenticated | `lesson_media_select` | `exists ( select 1 from app.lessons l join app.modules m on m.id = l.module_id join app.courses c on c.id = m.course_id where l.id = lesson_id and ( c.created_by = auth.uid() or app.is_admin(auth.uid()) or (c.is_published and l.is_intro = true) or exists ( select 1 from app.enrollments e where e.course_id = c.id and e.user_id = auth.uid() ) ) )` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.lesson_media` | enabled | all | public/auth/default | `lesson_media_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.lesson_media` | enabled | all | authenticated | `lesson_media_write` | `exists ( select 1 from app.lessons l join app.modules m on m.id = l.module_id join app.courses c on c.id = m.course_id where l.id = lesson_id and (c.created_by = auth.uid() or app.is_admin(auth.uid())) )` | `exists ( select 1 from app.lessons l join app.modules m on m.id = l.module_id join app.courses c on c.id = m.course_id where l.id = lesson_id and (c.created_by = auth.uid() or app.is_admin(auth.uid())) )` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.lesson_media` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.lessons` | enabled | select | authenticated | `lessons_select` | `exists ( select 1 from app.modules m join app.courses c on c.id = m.course_id where m.id = module_id and ( c.created_by = auth.uid() or app.is_admin(auth.uid()) or (c.is_published and is_intro = true) or exists ( select 1 from app.enrollments e where e.course_id = c.id and e.user_id = auth.uid() ) ) )` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.lessons` | enabled | all | public/auth/default | `lessons_service_role` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.lessons` | enabled | all | authenticated | `lessons_write` | `exists ( select 1 from app.modules m join app.courses c on c.id = m.course_id where m.id = module_id and (c.created_by = auth.uid() or app.is_admin(auth.uid())) )` | `exists ( select 1 from app.modules m join app.courses c on c.id = m.course_id where m.id = module_id and (c.created_by = auth.uid() or app.is_admin(auth.uid())) )` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.lessons` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.live_event_registrations` | enabled | select | authenticated | `live_event_registrations_read` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.live_events e where e.id = event_id and e.teacher_id = auth.uid() )` | `` | `supabase/migrations/20260102113500_live_events_rls.sql` |
| `app.live_event_registrations` | enabled | all | public/auth/default | `live_event_registrations_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/20260102113500_live_events_rls.sql` |
| `app.live_event_registrations` | enabled | all | authenticated | `live_event_registrations_write` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.live_events e where e.id = event_id and e.teacher_id = auth.uid() )` | `app.is_admin(auth.uid()) or exists ( select 1 from app.live_events e where e.id = event_id and ( e.teacher_id = auth.uid() or ( user_id = auth.uid() and ( (e.access_type = 'membership' and exists ( select 1 from app.memberships m where m.user_id = auth.uid() and m.status = 'active' and (m.end_date is null or m.end_date > now()) )) or (e.access_type = 'course' and exists ( select 1 from app.enrollments en where en.user_id = auth.uid() and en.course_id = e.course_id )) ) ) ) )` | `supabase/migrations/20260102113500_live_events_rls.sql` |
| `app.live_events` | enabled | select | authenticated | `live_events_access` | `teacher_id = auth.uid() or app.is_admin(auth.uid()) or ( access_type = 'membership' and exists ( select 1 from app.memberships m where m.user_id = auth.uid() and m.status = 'active' and (m.end_date is null or m.end_date > now()) ) ) or ( access_type = 'course' and exists ( select 1 from app.enrollments e where e.user_id = auth.uid() and e.course_id = course_id ) )` | `` | `supabase/migrations/20260102113500_live_events_rls.sql` |
| `app.live_events` | enabled | all | authenticated | `live_events_host_rw` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/20260102113500_live_events_rls.sql` |
| `app.live_events` | enabled | all | public/auth/default | `live_events_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/20260102113500_live_events_rls.sql` |
| `app.livekit_webhook_jobs` | enabled | all | public/auth/default | `livekit_jobs_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.livekit_webhook_jobs` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.media_objects` | enabled | all | authenticated | `media_owner_rw` | `owner_id = auth.uid() or app.is_admin(auth.uid())` | `owner_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.media_objects` | enabled | all | public/auth/default | `media_service_role` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.media_objects` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.meditations` | enabled | all | public/auth/default | `meditations_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.meditations` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.memberships` | enabled | select | authenticated | `memberships_self` | `user_id = auth.uid() or app.is_admin(auth.uid())` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.memberships` | enabled | all | public/auth/default | `memberships_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.memberships` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.messages` | enabled | all | authenticated | `messages_user` | `sender_id = auth.uid() or recipient_id = auth.uid() or app.is_admin(auth.uid())` | `sender_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.messages` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.modules` | enabled | all | authenticated | `modules_course_owner` | `exists ( select 1 from app.courses c where c.id = course_id and (c.created_by = auth.uid() or app.is_admin(auth.uid())) )` | `exists ( select 1 from app.courses c where c.id = course_id and (c.created_by = auth.uid() or app.is_admin(auth.uid())) )` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.modules` | enabled | all | public/auth/default | `modules_service_role` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.modules` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.notifications` | enabled | all | authenticated | `notifications_user` | `user_id = auth.uid() or app.is_admin(auth.uid())` | `user_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.notifications` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.orders` | enabled | all | public/auth/default | `orders_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.orders` | enabled | select | authenticated | `orders_user_read` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.services s where s.id = service_id and s.provider_id = auth.uid() )` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.orders` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.payment_events` | enabled | all | public/auth/default | `payment_events_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.payment_events` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.payments` | enabled | select | authenticated | `payments_read` | `exists ( select 1 from app.orders o where o.id = order_id and ( o.user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.services s where s.id = o.service_id and s.provider_id = auth.uid() ) ) )` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.payments` | enabled | all | public/auth/default | `payments_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.payments` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.posts` | enabled | all | authenticated | `posts_author` | `author_id = auth.uid() or app.is_admin(auth.uid())` | `author_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.posts` | enabled | all | public/auth/default | `posts_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.posts` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.profiles` | enabled | select | public/auth/default | `profiles_self_read` | `auth.uid() = user_id or app.is_admin(auth.uid())` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.profiles` | enabled | update | authenticated | `profiles_self_write` | `auth.uid() = user_id or app.is_admin(auth.uid())` | `auth.uid() = user_id or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.profiles` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.quiz_questions` | enabled | all | public/auth/default | `quiz_questions_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.quiz_questions` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.refresh_tokens` | enabled | all | public/auth/default | `refresh_tokens_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.refresh_tokens` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.reviews` | enabled | all | public/auth/default | `reviews_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.reviews` | enabled | all | authenticated | `reviews_user` | `reviewer_id = auth.uid() or app.is_admin(auth.uid())` | `reviewer_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.reviews` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.seminar_attendees` | enabled | select | authenticated | `attendees_read` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.seminars s where s.id = seminar_id and s.host_id = auth.uid() )` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_attendees` | enabled | all | public/auth/default | `attendees_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_attendees` | enabled | all | authenticated | `attendees_write` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.seminars s where s.id = seminar_id and s.host_id = auth.uid() )` | `user_id = auth.uid() or app.is_admin(auth.uid()) or exists ( select 1 from app.seminars s where s.id = seminar_id and s.host_id = auth.uid() )` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_attendees` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.seminar_recordings` | enabled | select | authenticated | `seminar_recordings_read` | `exists ( select 1 from app.seminars s where s.id = seminar_id and ( s.host_id = auth.uid() or app.is_admin(auth.uid()) or s.status in ('live','ended') ) )` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_recordings` | enabled | all | public/auth/default | `seminar_recordings_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_recordings` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.seminar_sessions` | enabled | all | authenticated | `seminar_sessions_host` | `exists ( select 1 from app.seminars s where s.id = seminar_id and (s.host_id = auth.uid() or app.is_admin(auth.uid())) )` | `exists ( select 1 from app.seminars s where s.id = seminar_id and (s.host_id = auth.uid() or app.is_admin(auth.uid())) )` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_sessions` | enabled | all | public/auth/default | `seminar_sessions_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminar_sessions` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.seminars` | enabled | all | authenticated | `seminars_host_rw` | `host_id = auth.uid() or app.is_admin(auth.uid())` | `host_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminars` | enabled | select | public | `seminars_public_read` | `status in ('scheduled','live','ended') or host_id = auth.uid() or app.is_admin(auth.uid())` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminars` | enabled | all | public/auth/default | `seminars_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.seminars` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.services` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.services` | enabled | all | authenticated | `services_owner_rw` | `provider_id = auth.uid() or app.is_admin(auth.uid())` | `provider_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.services` | enabled | select | public | `services_public_read` | `status = 'active' and active = true` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.services` | enabled | all | public/auth/default | `services_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.session_slots` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.session_slots` | enabled | all | authenticated | `session_slots_owner` | `exists ( select 1 from app.sessions s where s.id = session_id and (s.teacher_id = auth.uid() or app.is_admin(auth.uid())) )` | `exists ( select 1 from app.sessions s where s.id = session_id and (s.teacher_id = auth.uid() or app.is_admin(auth.uid())) )` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.session_slots` | enabled | all | public/auth/default | `session_slots_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.sessions` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.sessions` | enabled | all | authenticated | `sessions_owner` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.sessions` | enabled | select | public | `sessions_public_read` | `visibility = 'published' or teacher_id = auth.uid() or app.is_admin(auth.uid())` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.sessions` | enabled | all | public/auth/default | `sessions_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.stripe_customers` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.stripe_customers` | enabled | all | public/auth/default | `stripe_customers_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.tarot_requests` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.tarot_requests` | enabled | all | public/auth/default | `tarot_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_approvals` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.teacher_approvals` | enabled | all | public/auth/default | `teacher_approvals_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_directory` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.teacher_directory` | enabled | all | public/auth/default | `teacher_directory_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_payout_methods` | enabled | all | public/auth/default | `payout_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_payout_methods` | enabled | all | authenticated | `payout_teacher` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_payout_methods` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.teacher_permissions` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.teacher_permissions` | enabled | all | public/auth/default | `teacher_meta_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_profile_media` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.teacher_profile_media` | enabled | select | public | `tpm_public_read` | `is_published = true` | `` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teacher_profile_media` | enabled | all | authenticated | `tpm_teacher` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `teacher_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teachers` | enabled | all | public/auth/default | `service_role_full_access` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/007_rls_policies.sql` |
| `app.teachers` | enabled | all | authenticated | `teachers_owner` | `profile_id = auth.uid() or app.is_admin(auth.uid())` | `profile_id = auth.uid() or app.is_admin(auth.uid())` | `supabase/migrations/008_rls_app_policies.sql` |
| `app.teachers` | enabled | all | public/auth/default | `teachers_service` | `auth.role() = 'service_role'` | `auth.role() = 'service_role'` | `supabase/migrations/008_rls_app_policies.sql` |