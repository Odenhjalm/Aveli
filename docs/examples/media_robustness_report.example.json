{
  "summary": {
    "buckets_considered": [
      "course-media",
      "lesson-media",
      "public-media"
    ],
    "by_category": {
      "legacy_lesson_media": 2,
      "pipeline_media_asset": 1
    },
    "by_recommended_action": {
      "auto_migrate": 1,
      "keep": 1,
      "reupload_required": 1
    },
    "by_status": {
      "missing_bytes": 1,
      "needs_migration": 1,
      "ok": 1
    },
    "total_records": 3
  },
  "records": [
    {
      "bytes_exist": true,
      "category": "legacy_lesson_media",
      "issue_details": {
        "candidates": [
          {
            "bucket": "course-media",
            "key": "lessons/lesson-123/demo.png"
          },
          {
            "bucket": "course-media",
            "key": "course-media/lessons/lesson-123/demo.png"
          }
        ],
        "resolved_bucket": "course-media",
        "resolved_key": "lessons/lesson-123/demo.png",
        "storage_bucket": "course-media",
        "storage_path": "course-media/lessons/lesson-123/demo.png"
      },
      "issue_reason": "key_format_drift",
      "kind": "image",
      "lesson_media_id": "11111111-1111-1111-1111-111111111111",
      "media_id": "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",
      "proposed_updates": [
        {
          "fields": {
            "storage_path": "lessons/lesson-123/demo.png"
          },
          "id": "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",
          "table": "app.media_objects"
        }
      ],
      "recommended_action": "auto_migrate",
      "resolvable_for_editor": true,
      "resolvable_for_student": true,
      "status": "needs_migration",
      "storage_bucket": "course-media",
      "storage_path": "lessons/lesson-123/demo.png"
    },
    {
      "bytes_exist": false,
      "category": "legacy_lesson_media",
      "issue_details": {
        "candidates": [
          {
            "bucket": "course-media",
            "key": "lessons/lesson-456/missing.mp4"
          }
        ],
        "resolved_bucket": "course-media",
        "resolved_key": "lessons/lesson-456/missing.mp4",
        "storage_bucket": "course-media",
        "storage_path": "lessons/lesson-456/missing.mp4"
      },
      "issue_reason": "missing_object",
      "kind": "video",
      "lesson_media_id": "22222222-2222-2222-2222-222222222222",
      "media_id": null,
      "proposed_updates": [
        {
          "fields": {
            "details": {
              "candidates": [
                {
                  "bucket": "course-media",
                  "key": "lessons/lesson-456/missing.mp4"
                }
              ],
              "resolved_bucket": "course-media",
              "resolved_key": "lessons/lesson-456/missing.mp4",
              "storage_bucket": "course-media",
              "storage_path": "lessons/lesson-456/missing.mp4"
            },
            "issue": "missing_object"
          },
          "id": "22222222-2222-2222-2222-222222222222",
          "table": "app.lesson_media_issues"
        }
      ],
      "recommended_action": "reupload_required",
      "resolvable_for_editor": false,
      "resolvable_for_student": false,
      "status": "missing_bytes",
      "storage_bucket": "course-media",
      "storage_path": "lessons/lesson-456/missing.mp4"
    },
    {
      "bytes_exist": true,
      "category": "pipeline_media_asset",
      "issue_details": null,
      "issue_reason": null,
      "kind": "audio",
      "lesson_media_id": "33333333-3333-3333-3333-333333333333",
      "media_id": "bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb",
      "proposed_updates": [],
      "recommended_action": "keep",
      "resolvable_for_editor": true,
      "resolvable_for_student": true,
      "status": "ok",
      "storage_bucket": "course-media",
      "storage_path": "lessons/lesson-789/derived.mp3"
    }
  ]
}

