# Aveli monorepo baseline env file.
# Copy to .env for local development only; never commit real values.
# Generate new secrets with `openssl rand -hex 32` (JWT/media) or 64 for extra safety.

###############################################################
# Core application
###############################################################
APP_ENV=development
ENV=development
PORT=8080
API_BASE_URL=http://127.0.0.1:8080
FRONTEND_BASE_URL=http://localhost:3000

###############################################################
# Supabase (Postgres + Auth + Storage)
###############################################################
SUPABASE_PROJECT_REF=your-project-ref
SUPABASE_URL=https://${SUPABASE_PROJECT_REF}.supabase.co
SUPABASE_PUBLISHABLE_API_KEY=sb_publishable_replace
# Legacy publishable alias (optional)
# SUPABASE_PUBLIC_API_KEY=sb_publishable_replace
SUPABASE_SECRET_API_KEY=sb_secret_replace
# Legacy service role key (optional for older projects)
SUPABASE_SERVICE_ROLE_KEY=replace-with-service-role-key
SUPABASE_DB_PASSWORD=replace-with-db-password
SUPABASE_DB_URL=postgresql://postgres.${SUPABASE_PROJECT_REF}:${SUPABASE_DB_PASSWORD}@aws-1-eu-north-1.pooler.supabase.com:5432/postgres?sslmode=require
DATABASE_URL=${SUPABASE_DB_URL}
SUPABASE_PAT=replace-with-supabase-pat-for-cli
# Optional: Supabase JWT verification for access tokens.
# SUPABASE_JWKS_URL=${SUPABASE_URL}/auth/v1/.well-known/jwks.json
# SUPABASE_JWT_ISSUER=${SUPABASE_URL}/auth/v1

###############################################################
# Backend auth + media signing
###############################################################
JWT_SECRET=generate-64-hex-secret
JWT_ALGORITHM=HS256
JWT_EXPIRES_MINUTES=900
JWT_REFRESH_EXPIRES_MINUTES=1440
MEDIA_SIGNING_SECRET=generate-64-hex-secret
MEDIA_SIGNING_TTL_SECONDS=600
MEDIA_ROOT=backend/media
MEDIA_PUBLIC_CACHE_SECONDS=3600
MEDIA_ALLOW_LEGACY_MEDIA=true
LESSON_MEDIA_MAX_BYTES=2147483648

###############################################################
# Stripe (payments, subscriptions, Connect)
###############################################################
STRIPE_SECRET_KEY=sk_test_replace
STRIPE_PUBLISHABLE_KEY=pk_test_replace
STRIPE_WEBHOOK_SECRET=whsec_replace
STRIPE_BILLING_WEBHOOK_SECRET=whsec_replace
STRIPE_TEST_SECRET_KEY=sk_test_replace
STRIPE_TEST_PUBLISHABLE_KEY=pk_test_replace
# Optional if you only configure one webhook endpoint in test mode.
STRIPE_TEST_WEBHOOK_SECRET=
STRIPE_TEST_WEBHOOK_BILLING_SECRET=whsec_replace
STRIPE_LIVE_SECRET_KEY=sk_live_replace
STRIPE_LIVE_PUBLISHABLE_KEY=pk_live_replace
STRIPE_LIVE_WEBHOOK_SECRET=whsec_replace
STRIPE_LIVE_BILLING_WEBHOOK_SECRET=whsec_replace
STRIPE_CHECKOUT_UI_MODE=custom
STRIPE_MERCHANT_DISPLAY_NAME=Aveli
STRIPE_CONNECT_CLIENT_ID=ca_replace
STRIPE_CONNECT_RETURN_URL=http://localhost:3000/stripe/connect/return
STRIPE_CONNECT_REFRESH_URL=http://localhost:3000/stripe/connect/refresh
STRIPE_PRICE_MONTHLY=price_replace
STRIPE_PRICE_YEARLY=price_replace
# Optional service-specific prices: STRIPE_PRICE_SERVICE_{SLUG}=price_xxx
# Stripe Checkout return flow:
# - Frontend must handle /checkout/return and read session_id.
# - Backend verifies via GET /api/checkout/verify?session_id=...
STRIPE_RETURN_URL=https://app.aveli.app/checkout/return?session_id={CHECKOUT_SESSION_ID}
CHECKOUT_SUCCESS_URL=${STRIPE_RETURN_URL}
CHECKOUT_CANCEL_URL=https://app.aveli.app/checkout/cancel
# For local dev you can override with http://localhost:3000/checkout/return?session_id={CHECKOUT_SESSION_ID}

###############################################################
# LiveKit (SFU + webhooks)
###############################################################
LIVEKIT_WS_URL=wss://your-livekit-instance.livekit.cloud
LIVEKIT_API_URL=https://your-livekit-instance.livekit.cloud
LIVEKIT_API_KEY=LK_API_KEY
LIVEKIT_API_SECRET=LK_API_SECRET
LIVEKIT_WEBHOOK_SECRET=lk_webhook_secret

###############################################################
# Client/Flutter flags
###############################################################
SUBSCRIPTIONS_ENABLED=true
IMAGE_LOGGING=true

###############################################################
# Web / Next (landing) optional
###############################################################
NEXT_PUBLIC_SUPABASE_URL=${SUPABASE_URL}
# Prefer publishable key for client bundles; legacy alias shown below.
NEXT_PUBLIC_SUPABASE_ANON_KEY=${SUPABASE_PUBLISHABLE_API_KEY}
NEXT_PUBLIC_API_BASE_URL=${API_BASE_URL}
NEXT_PUBLIC_SENTRY_DSN=
SENTRY_DSN=

###############################################################
# QA / CI helpers
###############################################################
QA_API_BASE_URL=http://127.0.0.1:8080
QA_BASE_URL=http://127.0.0.1:8080
CI_DATABASE_URL=
CI_SUPABASE_URL=
CI_SUPABASE_PUBLISHABLE_API_KEY=
CI_SUPABASE_SECRET_API_KEY=
# Legacy CI aliases (optional)
# CI_SUPABASE_PUBLIC_API_KEY=
# CI_SUPABASE_SERVICE_ROLE_KEY=
CI_SUPABASE_DB_URL=
