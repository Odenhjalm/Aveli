[build]
  base = "frontend"
  # Flutter Web production builds MUST be configured via Netlify env vars and
  # injected at build time using --dart-define (compiled into the app).
  #
  # Required Netlify env vars:
  # - FLUTTER_API_BASE_URL
  # - FLUTTER_SUPABASE_URL
  # - FLUTTER_SUPABASE_PUBLIC_API_KEY
  # - FLUTTER_STRIPE_PUBLISHABLE_KEY
  # - FLUTTER_OAUTH_REDIRECT_WEB
  #
  # The build will fail fast if any are missing.
  command = "bash scripts/netlify_build_web.sh"
  publish = "build/web"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[[headers]]
  for = "/index.html"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

[[headers]]
  for = "/main.dart.js"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

[[headers]]
  for = "/flutter_bootstrap.js"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

[[headers]]
  for = "/flutter.js"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

[[headers]]
  for = "/version.json"
  [headers.values]
    Cache-Control = "no-cache, no-store, must-revalidate"

[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/canvaskit/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
